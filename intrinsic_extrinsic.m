function [XYZ0,u0,v0] = intrinsic_extrinsic(L)

XYZ0 = inv([L(1) L(2) L(3); L(5) L(6) L(7); L(9) L(10) L(11)])*[-L(4); -L(8); -1];

d = -1/sqrt(L(9)^2 + L(10)^2 + L(11)^2);

u0 = (L(1)*L(9) + L(2)*L(10) + L(3)*L(11))*d^2;
v0 = (L(5)*L(9) + L(6)*L(10) + L(7)*L(11))*d^2;

cu = sqrt(d^2 * (u0*L(9)-L(1))^2 + (u0*L(10)-L(2))^2 + (u0*L(11)-L(3))^2);
cv = sqrt(d^2 * (v0*L(9)-L(5))^2 + (v0*L(10)-L(6))^2 + (v0*L(11)-L(7))^2);

R11 = (d/cu) * (u0*L(9)-L(1));
R12 = (d/cu) * (u0*L(10)-L(2));
R13 = (d/cu) * (u0*L(11)-L(3));

R21 = (d/cv) * (u0*L(9)-L(5));
R22 = (d/cv) * (u0*L(10)-L(6));
R23 = (d/cv) * (u0*L(11)-L(7));

R31 = L(9)*d;
R32 = L(10)*d;
R33 = L(11)*d;

end

